---
slug: "rromeo"
title: Access Publisher Copyright & Self-Archiving Policies via the 'SHERPA/RoMEO' API
package_version: 0.1.0
authors:
  - Matthias Greni√©
  - Hugo Gruson
date: '2019-6-4'
categories: blog
topicid:
tags:
- Software Peer Review
- R
- community
- software
- packages
- rromeo
- SHERPA/RoMEO
- API
- open access
- scientific publications
- preprint
- postprint
---

We've been following rOpenSci for a long time, using several packages in our scientific projects, especially [`taxize`](https://github.com/ropensci/taxize/) to clean species names, [`rredlist`](https://github.com/ropensci/rredlist/) to extract species IUCN statuses or [`treeio`](https://github.com/ropensci/treeio) to work with phylogenetic trees. The thorough package review process greatly improves the quality of the packages that join the rOpenSci ecosystem. It is a great community to learn and develop new ideas, especially regarding scientifc packages.
As we admired the dynamics of rOpenSci community, we wanted to contribute to this ecosystem. So we first thought about the kind of project that could fit rOpenSci goals and that could, in the same time, teach us new things.
As young researchers, we know how much a scientific article can benefit from a detailed and helpful review. We were really curious to see what kind of new outlook on our work reviewers would bring here.

Open Access is the idea that scientific articles should be accessible to anyone to favour scientific dissemination, as well as public information. Open Access is rising in the scientific community with more and more public funding agencies requiring funded projects to make their article open access. Several models exist to foster Open Access. One way that open access can be done is the so-called ["green open-access"](https://en.wikipedia.org/wiki/Open_access#Green_OA) meaning that the articles are deposited by their authors and made publicly available through instutional or public repositories, such as [bioRxiv](https://www.biorxiv.org) or [HAL](https://hal.archives-ouvertes.fr/). Scientific journals have different policies regarding green open-access: some of them let you archive different versions of the manuscript right after acceptance while some others ask you to wait an embargo period, some forbid entirely the archival of the manuscript. In order to favour open-access of article scientists can choose to publish in journals that authorize such archival. That's where [SHERPA/RoMEO](http://sherpa.ac.uk/romeo/index.php) comes in handy, SHERPA/RoMEO is a publicly available database of open access policies of scientific journals. It indexes the conditions at which each journal let you (or not) host manuscript versions.

The SHERPA/RoMEO database is available through an [Application Programming Interface](https://en.wikipedia.org/wiki/Application_Programming_Interface) (API), so we thought we could build an R client to this API to make it accessible for individual scientists. With that researchers could more easily select journals based on their manuscript archival policies. Also these data can be used by bibliometricians to get the general picture of open access practices among journals of a particular subfield.

We had no prior experience working with web data or scrapping APIs for data but we knew that several tools in R existed to interact with APIs such as @hadley [`httr`](https://cran.r-project.org/package=httr), @sckott [`crul`](https://cran.r-project.org/package=crul) and many examples of R client for APIs available on the CRAN Task View on [Web Technologies](https://cran.r-project.org/web/views/WebTechnologies.html). So that is how we decided to begin the development of `rromeo`.

## SHERPA/RoMEO API

SHERPA/RoMEO has been available through a web interface since February 2004 according to the [Internet Archive](https://archive.org/). Their API has been available since December 2006 (from the Internet Archive <https://web.archive.org/web/20061211125806/http://www.sherpa.ac.uk:80/romeo.php>). Making their data available to anyone since then. However, at that time the API standards hadn't diffused as much as today. The development of the RoMEO API seems to have stopped since 2013 even though the database is still updated. There is even a [wishlist of functionalities regarding the API](http://sherpa.ac.uk/romeo/API-Wishlist-2012-10.html), that does not seem to be updated anymore.

The API grants you access to the archival policies of scientific journals and let you know whether the publisher accepts that authors archive differents versions of the manuscripts. There are three versions of the manuscript considered in SHERPA/RoMEO:
1. pre-print, which is the manuscript version **before peer-review**;
1. post-print, which is the manuscript as **accepted after peer-review** but not yet typeset as an article in the journal;
1. and typeset manuscript/publisher's manuscript, which is the manuscript with the text after peer-review **fully typeset** as it appears in the journal.
Depending on the journal some accept the archival only of the pre-print, while others accept both pre-print and post-print, and some journal even accept the archival of all three versions!
SHERPA/RoMEO's API let you know what is the policy of a journal using its name and whether restrictions apply such as embargo period before publicly archiving different manuscript versions.

```r
rromeo::rr_journal_name("Methods in Ecology and Evolution")
```

   ## ADD THE RESULT OF THE QUERY HERE

One difficulty arose during the development of `rromeo` from the fact that the API does not always follow modern web standards. This meant that some R packages could not be readily used but needed small adjustments first, e.g. the encoding of the returned query was latin-1 instead of the now common UTF-8 and this was not declared via header of the query. Furthermore the SHERPA/RoMEO is not [RESTful](https://en.wikipedia.org/wiki/Representational_state_transfer) and thus the query needed were a little more complex to design. Fortunately the developers had written a [full documentation](http://www.sherpa.ac.uk/romeo/apimanual.php?la=en&fIDnum=|&mode=simple#versions) of all different types of query.

The API returned XML document that we decided to parse using the `xml2` package.

Difficulty of the API that does not output all the information regarding a single journal when querying it -> Recursive function but

## rromeo: an R API client

`rromeo` let's you access basic information regarding the journal policies

```r
rromeo::rr_journal_name("Methods in Ecology and Evolution")
```

Interpret returned data in terms of manuscripts and embargo. Compare journals.
Explain subtility when return several journals

You can also get publisher information:
```
```

You can get a full overview of `rromeo` capabilities reading the [introductory vignette](https://docs.ropensci.org/rromeo/articles/rromeo.html).

## Developing an API package: lessons learned?

As we had no prior experience working with web technologies within R we learned a lot during `rromeo`'s development process.

   * use [vcr] to mock requests and have tests, [nice book](https://ropenscilabs.github.io/http-testing-book/) with examples to show you how to mock requests
   * use an API key and help the user store it (see our vignette that explains all the different ways to do it)
   * define a user-agent so that the maintainers from the API know where the calls come from (thanks to @brunaw)
   * use httpbin to test your requests and make sure they are retrieving what you think they are
   * fresh look thanks to review: it probably doesn't make sense for the output to be drastically different depending on a single argument (multiple = TRUE/FALSE)

Thanks to the reviewers

While working on rromeo, we realised that one of the major difficulties of developing an R API package was to decide the level of details offered to the user: if too high level, not flexible enough. If too low level, untractable. We were greatly inspired by the many packages developed by Scott Chamberlain that sometimes ofer two different interfaces for different kind of users (see [rredlist] for example). This strategy may be useful to offer different kind of granularity of information on details depending on the future use of the API information.

There exist many resources to develop API packages that we recommend to people who would like to develop one!:

   * [httr] vignette
   * Scott Chamberlain book
   * ?
   
## Giving back to the community

[vcr] and [webmockr] are recent rOpenSci packages that have mainly been used by a handful of developers until now, one of them being rOpenSci co-founder Scott Chamberlain. Scott often uses crul in his API packages while we used httr for rromeo. Both httr and crul have very similar goals but slightly different philosophies. We were able to identify issues with [vcr] and [webmockr] when used with [httr].

Reach out to the API developers to suggest updates?

## The future

rromeo is both on GitHub and CRAN now. It seems quite stable as it is now. There is more data in the SHERPA/RoMEO database that could be extracted especially regarding paid open access (<http://www.sherpa.ac.uk/romeo/PaidOA.php>). We'll be glad to add more functionality needed

We enjoyed the experience of contributing to rOpenSci, benefitting from great recommandations by the editor and reviewers of our package, as well as discovering bugs in lesser used package along the way.

We are now moving to another package that we plan to submit to rOpenSci. We'll be using some of the know we're moving to a new project, also an API package but bigger and hope to be back soon on the rOpenSci blog to talk about that ;)

## Acknowledgements

We would like to thank both of the reviewers of the rromeo package as well as the editor for their input to improve the documentation and the package.
We also want to mention Scott Chamberlain for building so many in tools to make the interactions with API easier ([vcr], [webmockr], crul, as well as many API packages that can be used as examples for developing your own API package).

- [httr]: https://github.com/r-lib/httr
- [rredlist]: https://github.com/ropensci/rredlist
- [vcr]: https://github.com/ropensci/vcr
- [webmockr]: https://github.com/ropensci/webmockr
